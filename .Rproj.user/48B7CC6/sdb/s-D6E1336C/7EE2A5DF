{
    "contents" : "library(xts)\nlibrary(lubridate)\n\nbon = read.csv('~/Downloads/wqmhourly_1469748047_697.csv')\nbon = bon[!is.na(bon$Hour),]\nhours = paste(as.numeric(bon$Hour) / 100, ':00', sep='')\ndates = as.character(bon$Date)\no = apply(cbind(dates, hours), 1, paste, collapse=' ')\ntimestamps = as.POSIXct(o)\nts.bon = xts(bon, order.by=timestamps)\n\nplot(ts.bon$Temperature..F.)\nplot(ts.bon['2015-06-01/2015-09-01']$Temperature..F.)\n\nplot(ts.bon['2015-06-01/2015-08-01']$Temperature..F.)\n\n##\nbon = read.csv('../Data/2015/BON_2015_BonnevilleForebay.csv')\ndalles = read.csv('../Data/2015/TDDO_2015_TheDalles.csv')\ndallesforebay = read.csv('../Data/2015/TD_2015_TheDallesForebay.csv')\nice = read.csv('../Data/2015/IDSW_2015_IceHarborTailwater.csv')\nice2016 = read.csv('../Data/2016/IDSW_2016_IceHarborTailwater.csv')\nlgw = read.csv('../Data/2015/LWG_2015_LowerGraniteForebay.csv')\nlgtail = read.csv('../Data/2015/LGNW_2015_LowerGraniteTailwater.csv')\nlgtail2016 = read.csv('../Data/2016/LGNW_2016_LowerGraniteTailwater.csv')\ndwo = read.csv('../Data/2015/DWQI_2015_DworshackTailwater.csv')\nlmontail = read.csv('../Data/2015/LMNW_2015_LowerMonumentalTailwater.csv')\nlmontail2016 = read.csv('../Data/2016/LMNW_2016_LowerMonumentalTailwater.csv')\nlgstail = read.csv('../Data/2015/LGSW_2015_LittleGooseTailwater.csv')\nlgstail2016 = read.csv('../Data/2016/LGSW_2016_LittleGooseTailwater.csv')\nwells = read.csv('../Data/2015/WEL_2015_Wells.csv')\nrockyreachtail = read.csv('../Data/2015/RRDW_2015_RockyReachTailwater.csv')\npriesttail = read.csv('../Data/2015/PRXW_2015_PriestRapidsDownstream.csv')\n# load from URL\nurl = 'http://www.cbr.washington.edu/dart/cs/php/rpt/wqm_hourly.php?sc=1&outputFormat=csv&year=2015&proj=LMNW&startdate=01%2F01&days=365'\nread.csv(url)\n\n\n  data = data[!is.na(data$Hour),]\n  #ata = data[1:8759,]\n  hours = paste(sprintf(\"%02d\", as.numeric(as.character(data$Hour))/100), ':00:00', sep='')\n  dates = as.character(data$Date)\n  o = apply(cbind(dates, hours), 1, paste, collapse=' ')\n  timestamps = as.POSIXct(o, \"Etc/GMT+8\")\n  head(timestamps)\n  ts.data = xts(data, order.by=timestamps)\n\nplot(ts.data$Temperature..F.)\nplot(ts.data['2015-06-01/2015-09-01']$Temperature..F.)\nplot(ts.data['2015-05-01/2015-10-01']$Temperature..F.)\n\n\nplot(ts.data['2015-08-01/2015-08-10']$Temperature..F., typ='p')\n\n\ntemp.timeseries = function(data) {\n  \n  data = data[!is.na(data$Hour),]\n  #ata = data[1:8759,]\n  hours = paste(sprintf(\"%02d\", as.numeric(as.character(data$Hour))/100), ':00:00', sep='')\n  dates = as.character(data$Date)\n  o = apply(cbind(dates, hours), 1, paste, collapse=' ')\n  timestamps = as.POSIXct(o, \"Etc/GMT+8\")\n  head(timestamps)\n  ts.data = xts(data, order.by=timestamps)\n  return(ts.data)\n}\n\ntemp.timeseries.daily = function(data) {\n  ts.data = temp.timeseries(data)\n  ts.data$Day = .indexyday(ts.data)\n  data.daily = ddply(as.data.frame(ts.data), c('Day'), summarize, daily.T = mean(Temperature..C.))\n  return(data.daily)\n}\n\nts.bon = temp.timeseries(bon)\nts.ice = temp.timeseries(ice)\nts.lgw = temp.timeseries(lgw)\nts.dwo = temp.timeseries(dwo)\nts.lgtail = temp.timeseries(lgtail)\nts.lmontail = temp.timeseries(lmontail)\nts.lgstail = temp.timeseries(lgstail)\n\nplot(ts.ice['2015-05-01/2015-10-01']$Temperature..F., ylim=c(40,80), main='Temperature 2015')\nlines(ts.lgw['2015-05-01/2015-10-01']$Temperature..F., col='blue')\nlines(ts.dwo['2015-05-01/2015-10-01']$Temperature..F., col='green')\nlegend('topleft', c('Ice Harbor Tailwater', 'Lower Granite Forebay', 'Dworshak Tailwater'), col=c('black', 'blue', 'green'),\n      lwd=1, cex=.7)\n\nrange = '2015-05-01/2015-10-01'\nplot(ts.lgw[range]$Temperature..F.)\nlines(ts.lgtail[range]$Temperature..F., col='blue')\n\nplot(ts.ice['2015-05-01/2015-10-01']$Temperature..F., ylim=c(60,75))\nlines(ts.lgw['2015-05-01/2015-10-01']$Temperature..F., col='blue')\nlegend('topleft', c('Ice Harbor Tailwater', 'Lower Granite Forebay'), col=c('black', 'blue'), lwd=1)\n\n# summer\n# range = .indexyday(ts.lgtail) >= 150 & .indexyday(ts.lgtail) <= 250\n\nplot(ts.lgtail[range]$Temperature..F., ylim=c(55, 75), main='Temperature 2015')\nlines(ts.lgstail[range]$Temperature..F., col='blue')\nlines(ts.lmontail[range]$Temperature..F., col='green')\nlines(ts.ice[range]$Temperature..F., col='orange')\nlegend('topleft', \n       c('Granite', 'Goose', 'Monumental', 'Ice'), \n       col=c('black', 'blue', 'green', 'orange'), lwd=1)\n\n\nplot(ts.lgtail[range]$Temperature..C., ylim=c(0, 30), main='Temperature 2015')\nlines(ts.lgstail[range]$Temperature..C., col='blue')\nlines(ts.lmontail[range]$Temperature..C., col='green')\nlines(ts.ice[range]$Temperature..C., col='orange')\nlegend('topleft', \n       c('Granite', 'Goose', 'Monumental', 'Ice'), \n       col=c('black', 'blue', 'green', 'orange'), lwd=1)\n\n\n\n\nlibrary(stringr)\nurl = 'http://www.cbr.washington.edu/dart/cs/php/rpt/wqm_hourly.php?sc=1&outputFormat=csv&year=YEAR&proj=PROJECT&startdate=01%2F01&days=365'\nyear = 2014\nprojects = c('LGNW', 'LGSW', 'LMNW', 'IDSW')\nts.all = NULL\nfor(p in 1:length(projects)){\n  url1 = str_replace(url, 'YEAR', year)\n  url1 = str_replace(url1, 'PROJECT', projects[p])\n  data = read.csv(url1)\n  ts = temp.timeseries(data)\n  if(is.null(ts.all)){\n    ts.all = ts$Temperature..F.\n  } else {\n    ts.all = merge(ts.all, ts$Temperature..F.)\n  }\n}\nnames(ts.all) = projects\n\nrange = paste0(year,'-05-01/', year,'-10-01')\nplot(ts.all[range]$LGNW, ylim=c(55, 75), main=paste0('Temperature ',year))\nlines(ts.all[range]$LGSW, col='blue')\nlines(ts.all[range]$LMNW, col='green')\nlines(ts.all[range]$IDSW, col='orange')\nlegend('topleft', \n       c('Granite', 'Goose', 'Monumental', 'Ice'), \n       col=c('black', 'blue', 'green', 'orange'), lwd=1)\n\n\nts.all.2014 = ts.all\n#ts.all.2016 = ts.all\n\nplot(ts.all.2014['2014-05-01/2014-10-01']$IDSW, ylim=c(55, 75), main='Temperature')\nlines(\n  xts(ts.ice['2015-05-01/2015-10-01']$Temperature..F., order.by = index(ts.all.2014['2014-05-01/2014-10-01']))\n  , col='blue')\nts.temp = xts(ts.all.2016, order.by=index(ts.all.2016) - years(2))\nlines(\n  ts.temp$IDSW,\n  col='red'\n  )\nlegend('topleft', c('2014', '2015', '2016'), col=c('black', 'blue' ,'red'), lwd=1)\n",
    "created" : 1469748086911.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1090088953",
    "id" : "7EE2A5DF",
    "lastKnownWriteTime" : 1471379109,
    "path" : "~/Documents/Projects/Columbia/R/DamTemperatures.R",
    "project_path" : "DamTemperatures.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}